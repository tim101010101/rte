# 2023-2-6

一个想法

把 isActive 移动到 textNode 上

因为如果一个 line 里面全是 textNode, 这样的话 behavior 就没有意义了, 因为无法得知此时是否激活

在这之前, 先解决 fence 的计算

算是勉强怼出逻辑了, 但是完全是一团乱麻, 还是希望重新考虑一下该怎么简化, 不然完全没有可维护性可言

主要的测试用例就几个

`*a_b_*`
`*a*_b_`
`a*b*`
`# a`
`# *a*`

大致思路就是, 分别遍历每个 ancestor, 使用全局变量来共享状态, 具体的其实就是 textOffset 和 prefixChange

要分别考虑激活和未被激活的两种情况

有点冒烟, 先睡觉
