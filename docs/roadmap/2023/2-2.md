# 2023-2-2

暂时卡在事件触发的逻辑

需要手动模拟事件程序, 这个本身是简单的, 但是该如何正确的触发事件呢

当用户点击页面, 可以监听事件得到点击的坐标, 那么要如何根据点击坐标来找到被点击的元素

这样的话也许会需要在 eventBus 中保存各个元素的 rect, 直接遍历 rect 来判断是否触发, 但是这样总觉得很不优雅

那就先暂时做个反向监听, 将现在的 EevntTarget 改为 VNodeEventTarget, 其中包括 VNode 和 rect, attach 的时候做一个小代理, 判断当前点击位置是否位于 rect 内, 再进行触发, 虽然还是 O(N), 但起码可以简化逻辑

emit 的时候就只需要传入原生的 e

而且这个判断是否触发其实主要是针对鼠标事件, 后面再来考虑优化

## 补档

今天做的比较杂, 但基本都是围绕 eventBus 在做文章, 然后对 renderer 做了一个小小的重构, 主要是将所有的 rect 改成了 ClientRect

即 renderer 的函数都接受 ClientRect, 返回 ClientRect, 因为之前没有考虑到画布本身会存在偏移以及 padding

eventBus 基本做好了, 剩下的需要先打通 page 到 listView 的数据链路

具体的, 实现点击插入光标的功能

此外还写了几个小小的工具函数, 防抖节流柯里化, 防抖和截流做了小测试, 柯里化还没有, 但应该没什么问题
